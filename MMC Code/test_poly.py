# -*- coding: utf-8 -*-
"""
Created on Fri Apr  5 10:18:14 2024

@author: presvotscor
"""

#import os
import numpy as np
import matplotlib.pyplot as plt

DATA_S_load=False
DATA_u_load=True
DATA_i_load=False



#DATA_S= np.loadtxt(r'D:\Users\presvotscor\Documents\These_clean\Code_MMC\database_TADN_RTE\DATA_S.txt').reshape((12066, 6, 21000))
#DATA_u= np.loadtxt(r'D:\Users\presvotscor\Documents\These_clean\Code_MMC\database_TADN_RTE\DATA_u.txt')
#DATA_i= np.loadtxt(r'D:\Users\presvotscor\Documents\These_clean\Code_MMC\database_TADN_RTE\DATA_i.txt')

#np.savez_compressed(r'D:\Users\presvotscor\Documents\These_clean\Code_MMC\DATA_u', DATA_u=DATA_u,)
#np.savez_compressed(r'D:\Users\presvotscor\Documents\These_clean\Code_MMC\DATA_i', DATA_i=DATA_i)
  



Delta=18.31055
       
Ts=1/6400
t=np.linspace(0,(21000-1)*Ts,21000)



if DATA_u_load==1:
    DATA_u = np.load(r'D:\Users\presvotscor\Documents\These_clean\Code_MMC\DATA_u.npz')['DATA_u']

    #DATA_u=loaded['DATA_u']
    print("shape u",np.shape(DATA_u))

      

    
        
    from Models import Model_poly
    
    
    model_poly =Model_poly(50,6400,128,False)
    
    from Normalize import normalize
    from Measures import curve_tex,inv_curve_tex
    
    order=0
    nb_w=55
    theta=np.zeros((nb_w,order+1))
    for w in range(nb_w):
        signal_poly,K=normalize(DATA_u[w]*Delta)
        theta_poly_hat=model_poly.get_theta_poly(signal_poly,[0]*(order+1),[10]*(order+1),order)
        
        theta[w]=theta_poly_hat
    
        
        if w in [3,5,7,10,26,42,51,54]:
            signal_poly_hat=model_poly.get_model_poly(t[0:128], *theta_poly_hat)*2**(K)
        
            fig=plt.figure(figsize=(8,5),dpi=100)
            plt.plot(t[0:128],DATA_u[w]*Delta,lw=2,label='v{}'.format(w))
            plt.plot(t[0:128],signal_poly_hat,lw=2,label='model poly-{}'.format(order))
            plt.xlabel('t [s]')
            plt.ylabel('Voltage (V)')
            plt.title('base de donn√©es, mean = {:.0f} V, std = {:.0f} V'.format(np.mean(DATA_u[w]*Delta),np.std(DATA_u[w]*Delta)))
            plt.grid( which='major', color='#666666', linestyle='-')
            plt.legend()
            plt.minorticks_on()
            
            print("w",w)
            curve_tex(np.array([i for i in range(128)]),DATA_u[w]*Delta/1000,1)
            #curve_tex(x_values,p_values,0)
            
    
    std_X=np.zeros(order+1)        
    for k in range(order+1):
        X=[theta[i,k] for i in range(nb_w)]
        std_X[k]=np.std(X)
        fig=plt.figure(figsize=(8,5),dpi=100)
        plt.hist(X, range = (-4*std_X[k], 4*std_X[k]), bins = 100)
        plt.xlabel('valeurs')
        plt.ylabel('nombres')
        plt.title('poly-{}, theta {}, std={:.2f}'.format(order,k,std_X[k]))
        plt.grid( which='major', color='#666666', linestyle='-')
        #plt.legend()
        plt.minorticks_on()
     
    fig=plt.figure(figsize=(8,5),dpi=100)
    plt.plot(std_X,"-*",lw=2,)
    plt.xlabel('order')
    plt.ylabel('sigma')
    plt.title("poly-{}, Evolution de sigma en fonction de l'ordre".format(order))
    plt.grid( which='major', color='#666666', linestyle='-')
    plt.minorticks_on() 
    





x_rec_c3= [-0.2020883560180664, -0.17683152854442596, -0.13397793471813202, -0.10572116822004318, -0.052648235112428665, -0.018333371728658676, 0.014740902930498123, 0.08705072849988937, 0.14472442865371704, 0.191501647233963, 0.2307390421628952, 0.28610846400260925, 0.337475448846817, 0.36940544843673706, 0.4174787104129791, 0.4609830677509308, 0.5210527181625366, 0.5516403913497925, 0.5842222571372986, 0.6292108297348022, 0.6771616339683533, 0.718036413192749, 0.7410510778427124, 0.7699116468429565, 0.7727522253990173, 0.7922396659851074, 0.8346259593963623, 0.8593582510948181, 0.8878934383392334, 0.923021674156189, 0.9467158317565918, 0.9526878595352173, 0.9443434476852417, 0.9137371182441711, 0.8617124557495117, 0.7276663184165955, 0.4665512442588806, 0.29986855387687683, 0.1171136125922203, 0.023691613227128983, 0.0661635771393776, 0.11214376240968704, 0.17799226939678192, 0.273227721452713, 0.2345404326915741, 0.22432799637317657, 0.1567995250225067, 0.09697917103767395, 0.07348092645406723, 0.09212959557771683, 0.1134529858827591, 0.1468474119901657, 0.18246716260910034, 0.19121453166007996, 0.17193946242332458, 0.13059988617897034, 0.10768108069896698, 0.10316328704357147, 0.12833954393863678, 0.09859868139028549, 0.11687474697828293, 0.11965951323509216, 0.11644373089075089, 0.11556468158960342, 0.1020832285284996, 0.08980604261159897, 0.0739867314696312, 0.059269919991493225, 0.04624830558896065, 0.04207131639122963, 0.03041650727391243, 0.02847379446029663, 0.02718823030591011, 0.02191716805100441, 0.019671078771352768, 0.011656681075692177, 0.0014486727304756641, -0.008353978395462036, -0.017929870635271072, -0.030969589948654175, -0.04205026105046272, -0.047188710421323776, -0.05447405204176903, -0.06049071624875069, -0.06678125262260437, -0.06791355460882187, -0.07673338055610657, -0.08318198472261429, -0.0919327661395073, -0.09658295661211014, -0.09814883023500443, -0.10348179191350937, -0.10191472619771957, -0.10013487190008163, -0.10300140827894211, -0.10560432821512222, -0.11711546778678894, -0.12447631359100342, -0.13731637597084045, -0.14861302077770233, -0.16208481788635254, -0.16651709377765656, -0.17267879843711853, -0.17323458194732666, -0.1710086166858673, -0.16747567057609558, -0.164962038397789, -0.159553661942482, -0.15857723355293274, -0.1544298231601715, -0.15738287568092346, -0.1582614630460739, -0.16253052651882172, -0.1616617888212204, -0.16020295023918152, -0.15827764570713043, -0.14978596568107605, -0.14704596996307373, -0.14143024384975433, -0.13928742706775665, -0.1432589590549469, -0.14116089046001434, -0.14987358450889587, -0.14937101304531097, -0.14555317163467407, -0.14031745493412018, -0.1384081095457077, -0.13035908341407776]
x_rec_d3= [-0.2280350774526596, -0.20385989546775818, -0.16088703274726868, -0.13347098231315613, -0.08084962517023087, -0.0467892549932003, -0.013573240488767624, 0.05894607678055763, 0.11682306975126266, 0.16444221138954163, 0.2025095820426941, 0.25773951411247253, 0.30861636996269226, 0.34141436219215393, 0.38633084297180176, 0.4304402768611908, 0.48881158232688904, 0.5207377672195435, 0.5545167922973633, 0.6029973030090332, 0.659195065498352, 0.7045605778694153, 0.7326459884643555, 0.7633570432662964, 0.7635072469711304, 0.7809721827507019, 0.8234924077987671, 0.8464659452438354, 0.8829704523086548, 0.9228414297103882, 0.9511406421661377, 0.961777925491333, 0.948142945766449, 0.909284234046936, 0.8514504432678223, 0.7143895030021667, 0.4525294303894043, 0.28839370608329773, 0.11127655953168869, 0.023516792804002762, 0.06395707279443741, 0.10836974531412125, 0.16418468952178955, 0.2597971558570862, 0.2159212827682495, 0.20431210100650787, 0.14117799699306488, 0.08661512285470963, 0.07163820415735245, 0.09991604834794998, 0.12534135580062866, 0.163792222738266, 0.1980428248643875, 0.20602987706661224, 0.18489840626716614, 0.13964496552944183, 0.11926832050085068, 0.11551761627197266, 0.13827863335609436, 0.10634015500545502, 0.11667393147945404, 0.11460649222135544, 0.10569312423467636, 0.10160493105649948, 0.09395141154527664, 0.08857918530702591, 0.08041452616453171, 0.07212172448635101, 0.0640864148736, 0.060195568948984146, 0.048546746373176575, 0.042171213775873184, 0.03674875572323799, 0.029696226119995117, 0.02737647481262684, 0.018819771707057953, 0.013779409229755402, 0.00627312483265996, 0.0018722009845077991, -0.005770235788077116, -0.015552621334791183, -0.019898265600204468, -0.02973579242825508, -0.035876307636499405, -0.04550568386912346, -0.04718509688973427, -0.05576428025960922, -0.062615305185318, -0.06988314539194107, -0.07558297365903854, -0.0808144211769104, -0.08950233459472656, -0.09685169160366058, -0.10039075464010239, -0.10851842910051346, -0.1161298081278801, -0.1265837848186493, -0.1311762034893036, -0.13929858803749084, -0.1462058573961258, -0.15361887216567993, -0.1557052880525589, -0.16131708025932312, -0.16413024067878723, -0.1683412790298462, -0.16924846172332764, -0.17293861508369446, -0.17398209869861603, -0.17419014871120453, -0.17208100855350494, -0.17298918962478638, -0.1706690490245819, -0.17083382606506348, -0.16558954119682312, -0.1650981903076172, -0.16209213435649872, -0.15691830217838287, -0.15497742593288422, -0.14995184540748596, -0.144921213388443, -0.1415558010339737, -0.13472923636436462, -0.13558648526668549, -0.13089139759540558, -0.12811720371246338, -0.12317398190498352, -0.12213975191116333, -0.11778431385755539]
SNRc3=12.9
SNRd3=13.0
Hc3=159.4
R3=121
x_rec_c5= [-0.16009290516376495, -0.13000522553920746, -0.08964196592569351, -0.057888712733983994, -0.001505162101238966, 0.03128919377923012, 0.06876342743635178, 0.13358880579471588, 0.18541353940963745, 0.22639545798301697, 0.2666743993759155, 0.3198610246181488, 0.37858930230140686, 0.407819002866745, 0.46325233578681946, 0.5097892880439758, 0.5746104717254639, 0.613738477230072, 0.6559051275253296, 0.7006441354751587, 0.7477298378944397, 0.7644327878952026, 0.7756237983703613, 0.789374053478241, 0.8098161220550537, 0.8270168304443359, 0.8542956113815308, 0.8810064792633057, 0.8813391923904419, 0.9045360088348389, 0.9355471730232239, 0.9366642236709595, 0.936285674571991, 0.9551562666893005, 0.9393939971923828, 0.8573468923568726, 0.6693335771560669, 0.5134100317955017, 0.33155032992362976, 0.18444374203681946, 0.07728073745965958, 0.04278573766350746, 0.10246159881353378, 0.17992092669010162, 0.32107722759246826, 0.41947343945503235, 0.5538835525512695, 0.6227043867111206, 0.5874189138412476, 0.5833596587181091, 0.46134504675865173, 0.4006405770778656, 0.260598748922348, 0.1871594488620758, 0.10655120760202408, 0.11128038913011551, 0.13206645846366882, 0.16847454011440277, 0.2631551921367645, 0.3311210572719574, 0.3696526288986206, 0.42007121443748474, 0.38655441999435425, 0.3426233232021332, 0.25838932394981384, 0.15666934847831726, 0.09212241321802139, 0.012157861143350601, -0.028437282890081406, -0.04216783866286278, -0.06482236087322235, -0.050275202840566635, -0.008609678596258163, 0.01001192256808281, 0.05358872190117836, 0.04163149371743202, 0.020170588046312332, -0.00785009190440178, -0.07147406041622162, -0.13359953463077545, -0.19044429063796997, -0.2294166088104248, -0.24021734297275543, -0.26222845911979675, -0.2465851753950119, -0.22507783770561218, -0.22331462800502777, -0.218228280544281, -0.21839895844459534, -0.22146232426166534, -0.23461493849754333, -0.27986958622932434, -0.3103134334087372, -0.34089797735214233, -0.3863750994205475, -0.42091432213783264, -0.4435097575187683, -0.45053499937057495, -0.4455004930496216, -0.4440525770187378, -0.4238889217376709, -0.40344399213790894, -0.3905060589313507, -0.37870296835899353, -0.38206836581230164, -0.3791429400444031, -0.3967238962650299, -0.4098431468009949, -0.4200192391872406, -0.4196939766407013, -0.4243680238723755, -0.4163402318954468, -0.4017108380794525, -0.3775245249271393, -0.3609161674976349, -0.3479875326156616, -0.3369431793689728, -0.3327111601829529, -0.32467544078826904, -0.31691813468933105, -0.31441619992256165, -0.30270716547966003, -0.29960086941719055, -0.28358057141304016, -0.26826637983322144, -0.25266486406326294, -0.24025240540504456, -0.22803038358688354]
x_rec_d5= [-0.16988605260849, -0.14078807830810547, -0.10053954273462296, -0.07039996236562729, -0.013173859566450119, 0.020398680120706558, 0.056787457317113876, 0.12265945225954056, 0.17401528358459473, 0.21458277106285095, 0.2547265291213989, 0.3040190637111664, 0.35813015699386597, 0.3854169547557831, 0.43049541115760803, 0.4712274372577667, 0.5299183130264282, 0.5639744997024536, 0.6053240895271301, 0.6497074365615845, 0.7045201659202576, 0.7277528643608093, 0.7446435689926147, 0.7672459483146667, 0.7909066677093506, 0.8088345527648926, 0.836592435836792, 0.8594976663589478, 0.8558981418609619, 0.8772833347320557, 0.9054893851280212, 0.9066305756568909, 0.9130309820175171, 0.9373613595962524, 0.9217483401298523, 0.8383148908615112, 0.6459182500839233, 0.4906631410121918, 0.30344441533088684, 0.1600613296031952, 0.06364057213068008, 0.040329787880182266, 0.10830452293157578, 0.1976049393415451, 0.33554527163505554, 0.4316110908985138, 0.5590533018112183, 0.6216633915901184, 0.5893118381500244, 0.5862268805503845, 0.4673388600349426, 0.401091068983078, 0.2474549412727356, 0.16517628729343414, 0.07707113772630692, 0.07344470173120499, 0.1058429703116417, 0.15009468793869019, 0.25131988525390625, 0.3235406279563904, 0.354131817817688, 0.396994948387146, 0.34934163093566895, 0.29330864548683167, 0.20732533931732178, 0.1079254224896431, 0.05589679256081581, -0.011262442916631699, -0.02527628466486931, -0.027437273412942886, -0.03616389259696007, -0.021596640348434448, 0.010326612740755081, 0.0221211276948452, 0.06060352548956871, 0.03697953000664711, 0.023271504789590836, -0.002441118936985731, -0.06007887050509453, -0.11731768399477005, -0.1807592213153839, -0.22960448265075684, -0.24907970428466797, -0.27694833278656006, -0.2649114727973938, -0.2422218769788742, -0.2373887598514557, -0.2276594191789627, -0.23196864128112793, -0.2401657998561859, -0.2619667947292328, -0.3092438280582428, -0.34088894724845886, -0.3713158369064331, -0.4116753041744232, -0.4441011846065521, -0.46856576204299927, -0.4754606783390045, -0.47251519560813904, -0.4689464569091797, -0.44450435042381287, -0.4227064549922943, -0.40680500864982605, -0.3955148458480835, -0.4073643982410431, -0.41034582257270813, -0.4339519441127777, -0.446915864944458, -0.4476764500141144, -0.4412456154823303, -0.43238502740859985, -0.4138530492782593, -0.397575706243515, -0.3734804689884186, -0.3621807396411896, -0.34905165433883667, -0.3385690748691559, -0.3347227871417999, -0.3236156702041626, -0.31261587142944336, -0.311719685792923, -0.3022376596927643, -0.29829141497612, -0.27690809965133667, -0.25331732630729675, -0.2286696434020996, -0.20636281371116638, -0.18368291854858398]
SNRc5=25.2
SNRd5=24.7
Hc5=199.0
R5=152
x_rec_c7= [1.6578490734100342, 1.669569730758667, 1.7120873928070068, 1.7127147912979126, 1.8248591423034668, 1.8182332515716553, 1.815429925918579, 1.8433358669281006, 1.8165429830551147, 1.76720130443573, 1.7698822021484375, 1.6854077577590942, 1.614490032196045, 1.5491185188293457, 1.4425482749938965, 1.3579084873199463, 1.3817204236984253, 1.370876431465149, 1.4296875, 1.3875733613967896, 1.2901355028152466, 1.2141056060791016, 1.0859624147415161, 0.9741749167442322, 0.9619926810264587, 0.9463164210319519, 0.9814541339874268, 0.9592782258987427, 0.9079209566116333, 0.8618083596229553, 0.8016313910484314, 0.7080467343330383, 0.6144227385520935, 0.5577969551086426, 0.4851478934288025, 0.4364318549633026, 0.3563528060913086, 0.33606547117233276, 0.26484400033950806, 0.18553300201892853, 0.11636260896921158, 0.04816979914903641, 0.008082830347120762, -0.0782771036028862, -0.14672712981700897, -0.19385920464992523, -0.249983549118042, -0.3241609036922455, -0.42390668392181396, -0.4916006326675415, -0.5682299733161926, -0.6289950609207153, -0.6909574866294861, -0.7050304412841797, -0.7483885884284973, -0.7919867634773254, -0.8523464202880859, -0.9004888534545898, -0.9615440964698792, -1.0501502752304077, -1.113307237625122, -1.1475368738174438, -1.215545892715454, -1.2603013515472412, -1.3383488655090332, -1.3777456283569336, -1.4298655986785889, -1.4778348207473755, -1.5098929405212402, -1.526640772819519, -1.5518561601638794, -1.5673739910125732, -1.6135098934173584, -1.6229472160339355, -1.6762866973876953, -1.708876609802246, -1.7196094989776611, -1.7118134498596191, -1.7293692827224731, -1.7057169675827026, -1.7135562896728516, -1.6889102458953857, -1.6914100646972656, -1.6818592548370361, -1.644723653793335, -1.6297481060028076, -1.5951719284057617, -1.552065372467041, -1.5396487712860107, -1.5033435821533203, -1.511364459991455, -1.496438980102539, -1.4717246294021606, -1.4444879293441772, -1.4545221328735352, -1.41531503200531, -1.3834960460662842, -1.3550465106964111, -1.3122539520263672, -1.281489372253418, -1.205664873123169, -1.172271966934204, -1.1077353954315186, -1.0465850830078125, -1.0242016315460205, -0.9808846116065979, -0.9852931499481201, -0.9623832106590271, -0.9299618601799011, -0.9064670205116272, -0.9013051390647888, -0.8587799668312073, -0.8120964765548706, -0.783997654914856, -0.7389088273048401, -0.7159183621406555, -0.669460117816925, -0.653486430644989, -0.6093476414680481, -0.5616711974143982, -0.5301253199577332, -0.4862803518772125, -0.46903499960899353, -0.43444985151290894, -0.4056399464607239, -0.3744949698448181, -0.35854318737983704, -0.3265362083911896]
x_rec_d7= [1.6454681158065796, 1.6538989543914795, 1.6936842203140259, 1.6914786100387573, 1.7950539588928223, 1.7842806577682495, 1.7786532640457153, 1.8033607006072998, 1.7734373807907104, 1.7249308824539185, 1.7281010150909424, 1.6428306102752686, 1.5756103992462158, 1.5090287923812866, 1.3996589183807373, 1.3121061325073242, 1.3307299613952637, 1.3091540336608887, 1.3612393140792847, 1.314375877380371, 1.215065836906433, 1.1472020149230957, 1.0272873640060425, 0.9349232316017151, 0.9501551985740662, 0.9490289688110352, 0.994124710559845, 0.9713032245635986, 0.8951207399368286, 0.8375820517539978, 0.7506788372993469, 0.6412888169288635, 0.5538183450698853, 0.5084695816040039, 0.4547022879123688, 0.40595969557762146, 0.32420018315315247, 0.29674074053764343, 0.20867909491062164, 0.11571609228849411, 0.04557288438081741, -0.01755335181951523, -0.05253495275974274, -0.13172787427902222, -0.19422326982021332, -0.2396932989358902, -0.2886596918106079, -0.3549688160419464, -0.4418606162071228, -0.4958817958831787, -0.5689273476600647, -0.6330417394638062, -0.7172724604606628, -0.7482203841209412, -0.8129146695137024, -0.8714215159416199, -0.9318141341209412, -0.9718204140663147, -1.0197336673736572, -1.088808536529541, -1.1438690423965454, -1.1693949699401855, -1.2348284721374512, -1.2770360708236694, -1.3540058135986328, -1.395890235900879, -1.4513696432113647, -1.5075932741165161, -1.5534652471542358, -1.5812742710113525, -1.6166683435440063, -1.6323823928833008, -1.6644816398620605, -1.662169098854065, -1.693887710571289, -1.710503101348877, -1.7176402807235718, -1.7050864696502686, -1.728909969329834, -1.709463119506836, -1.7195234298706055, -1.6967992782592773, -1.6988770961761475, -1.6958906650543213, -1.665616750717163, -1.6586469411849976, -1.6348613500595093, -1.5947387218475342, -1.5805180072784424, -1.537923812866211, -1.5353885889053345, -1.5074737071990967, -1.4726943969726562, -1.438834309577942, -1.4405416250228882, -1.3936351537704468, -1.354929804801941, -1.317216157913208, -1.277893304824829, -1.2542294263839722, -1.200305700302124, -1.182124376296997, -1.1337553262710571, -1.0794864892959595, -1.0463922023773193, -0.9901137351989746, -0.9737266898155212, -0.9303343892097473, -0.8868082165718079, -0.8555118441581726, -0.852496862411499, -0.8121262192726135, -0.7690426111221313, -0.7458958029747009, -0.700489342212677, -0.6802129745483398, -0.6337431073188782, -0.6205243468284607, -0.5770365595817566, -0.5345473289489746, -0.5027202367782593, -0.45499563217163086, -0.4450944662094116, -0.4123377799987793, -0.3926728367805481, -0.3655155301094055, -0.35778018832206726, -0.33532971143722534]
SNRc7=16.2
SNRd7=16.2
Hc7=94.3
R7=94
x_rec_c10= [0.0537961907684803, 0.07319527864456177, 0.09301469475030899, 0.11284912377595901, 0.13784269988536835, 0.15722216665744781, 0.1780276596546173, 0.20542889833450317, 0.23135560750961304, 0.2513624429702759, 0.2758689224720001, 0.30241093039512634, 0.33122220635414124, 0.34882208704948425, 0.3788406252861023, 0.399247944355011, 0.4198903441429138, 0.43091556429862976, 0.44848766922950745, 0.46419039368629456, 0.48089566826820374, 0.493721604347229, 0.50590980052948, 0.5159643292427063, 0.5245951414108276, 0.529221773147583, 0.5358452796936035, 0.5446714162826538, 0.5477490425109863, 0.5446888208389282, 0.5546058416366577, 0.5507654547691345, 0.5573700070381165, 0.5516466498374939, 0.5558531284332275, 0.5558133721351624, 0.5450337529182434, 0.5439647436141968, 0.5335519313812256, 0.5190814733505249, 0.5126245021820068, 0.49998870491981506, 0.5015550255775452, 0.48634615540504456, 0.4716012179851532, 0.4567263424396515, 0.4441230297088623, 0.4161199927330017, 0.3865334689617157, 0.35701784491539, 0.33142074942588806, 0.308803528547287, 0.2791029214859009, 0.27743396162986755, 0.2516463100910187, 0.2326188087463379, 0.21170467138290405, 0.18402720987796783, 0.167661651968956, 0.13112333416938782, 0.09601849317550659, 0.07223648577928543, 0.05366726592183113, 0.023603472858667374, -0.009832408279180527, -0.022571470588445663, -0.05185425654053688, -0.07575394958257675, -0.12148744612932205, -0.12508924305438995, -0.16069456934928894, -0.1736815869808197, -0.19745105504989624, -0.21235431730747223, -0.24207468330860138, -0.27382728457450867, -0.3199841380119324, -0.35216519236564636, -0.39605578780174255, -0.4176105856895447, -0.4033377170562744, -0.3721153438091278, -0.36094599962234497, -0.3444930613040924, -0.3288421928882599, -0.31690263748168945, -0.29327863454818726, -0.2501601278781891, -0.1310684084892273, -0.04649835452437401, 0.05099525675177574, 0.08635363727807999, 0.05264664068818092, 0.05004512518644333, -0.043940868228673935, -0.10083913058042526, -0.11030962318181992, -0.11492686718702316, -0.055265121161937714, -0.05269080027937889, -0.013719689100980759, 0.0037798103876411915, -0.00040597052429802716, -0.014739729464054108, -0.02877943590283394, -0.022743571549654007, -0.021688561886548996, -0.03266816958785057, -0.021548312157392502, -0.029937829822301865, -0.031039725989103317, -0.038577381521463394, -0.04752777889370918, -0.06146283075213432, -0.06286580115556717, -0.06517674773931503, -0.06383723765611649, -0.05336716026067734, -0.0398857407271862, -0.029227301478385925, -0.027252238243818283, -0.020397072657942772, -0.03859827294945717, -0.04060308262705803, -0.05859687924385071, -0.06081350892782211, -0.07342644780874252, -0.08158846944570541]
x_rec_d10= [0.07589322328567505, 0.09280765801668167, 0.11011060327291489, 0.12774211168289185, 0.14826571941375732, 0.16371065378189087, 0.18204867839813232, 0.20547477900981903, 0.22804822027683258, 0.24583302438259125, 0.2678184509277344, 0.2936680018901825, 0.32167327404022217, 0.3383072018623352, 0.36936333775520325, 0.3902886211872101, 0.4117405116558075, 0.4232438802719116, 0.440166711807251, 0.45568132400512695, 0.4715166985988617, 0.483236163854599, 0.49539536237716675, 0.5061407685279846, 0.5180422067642212, 0.5244787335395813, 0.53596031665802, 0.5467150211334229, 0.5511363744735718, 0.5495821237564087, 0.5575175881385803, 0.5520160794258118, 0.5551576614379883, 0.5456755757331848, 0.5485718250274658, 0.5466539859771729, 0.5366148352622986, 0.5362235307693481, 0.5264930725097656, 0.5135636329650879, 0.5060518980026245, 0.49266281723976135, 0.4905053377151489, 0.47566667199134827, 0.4602563679218292, 0.44526609778404236, 0.4379248321056366, 0.4153684675693512, 0.3937038481235504, 0.3740002512931824, 0.35137036442756653, 0.3321742117404938, 0.3000020384788513, 0.29445680975914, 0.26329556107521057, 0.23941121995449066, 0.2173130214214325, 0.19051797688007355, 0.1780170500278473, 0.14508885145187378, 0.11378315836191177, 0.09294114261865616, 0.07479752600193024, 0.04434490576386452, 0.008375290781259537, -0.009789850562810898, -0.04347143694758415, -0.07206686586141586, -0.12410902231931686, -0.13044825196266174, -0.16891689598560333, -0.18214726448059082, -0.20535197854042053, -0.22011655569076538, -0.2490682750940323, -0.2785128653049469, -0.3254298269748688, -0.357014924287796, -0.3987286686897278, -0.418559730052948, -0.40153998136520386, -0.36515170335769653, -0.35361969470977783, -0.3387969136238098, -0.3297975957393646, -0.32467690110206604, -0.3096865117549896, -0.27428528666496277, -0.1575290858745575, -0.07377322763204575, 0.025012824684381485, 0.062269438058137894, 0.030923686921596527, 0.028966140002012253, -0.0645858570933342, -0.12200946360826492, -0.13249921798706055, -0.13896998763084412, -0.07995864003896713, -0.07724297046661377, -0.03566349670290947, -0.017775487154722214, -0.02147762104868889, -0.03468922898173332, -0.05246580019593239, -0.047858789563179016, -0.04502619430422783, -0.05375392735004425, -0.034022461622953415, -0.036413874477148056, -0.029845979064702988, -0.030759986490011215, -0.040810201317071915, -0.05789016932249069, -0.06675136834383011, -0.07533515989780426, -0.08409940451383591, -0.07684256881475449, -0.06655489653348923, -0.052388351410627365, -0.04440653696656227, -0.03464086726307869, -0.04910677298903465, -0.04944448918104172, -0.07290147244930267, -0.08140745013952255, -0.09839589148759842, -0.1133628785610199]
SNRc10=10.0
SNRd10=10.0
Hc10=110.3
R10=108
x_rec_c26= [-0.0018696860643103719, -0.001520784106105566, -0.0018196767196059227, -0.0012693912722170353, 0.001226009801030159, 0.002510375576093793, 0.002297543454915285, 0.005846788175404072, 0.0060643646866083145, 0.005067804362624884, 0.004653282929211855, 0.003555652219802141, 0.001770546194165945, 0.0018015513196587563, -0.00018213738803751767, -0.0004919087514281273, 0.0013441047631204128, 0.005304314661771059, 0.007297242525964975, 0.009312434121966362, 0.008868335746228695, 0.009069137275218964, 0.006426599342375994, 0.003913229797035456, -0.0003077048168051988, -0.0011883596889674664, -0.0054500713013112545, -0.00650682533159852, -0.008017180487513542, -0.008615309372544289, -0.008027889765799046, -0.006128532346338034, -0.0018001343123614788, 0.003989799413830042, 0.004577768500894308, 0.006731303874403238, 0.004126742947846651, 0.0021274532191455364, 0.0009861963335424662, -0.00024034248781390488, 0.00592387281358242, 0.011392000131309032, 0.019007962197065353, 0.024534933269023895, 0.025727558881044388, 0.02860824391245842, 0.02470901608467102, 0.022024016827344894, 0.018183819949626923, 0.015835091471672058, 0.01665591076016426, 0.015285062603652477, 0.01648695021867752, 0.014430815353989601, 0.011844814755022526, 0.0051723564974963665, -0.002165574114769697, -0.006918895523995161, -0.012032363563776016, -0.014253605157136917, -0.011242675594985485, -0.01053018867969513, -0.003729599993675947, -0.001980458851903677, -0.004976978991180658, -0.00595082575455308, -0.010544776916503906, -0.007485977839678526, -0.0021904739551246166, -0.004292208235710859, -0.001884672325104475, -0.007447581272572279, -0.024753574281930923, -0.036189448088407516, -0.04691614583134651, -0.03564634919166565, -0.0064635383896529675, 0.014047946780920029, 0.06343256682157516, 0.10216761380434036, 0.11897850781679153, 0.14595377445220947, 0.14527973532676697, 0.15288496017456055, 0.1444995254278183, 0.12939044833183289, 0.12330611795186996, 0.10916774719953537, 0.09276233613491058, 0.08574987947940826, 0.09142792969942093, 0.12286015599966049, 0.17871400713920593, 0.20941224694252014, 0.2749042212963104, 0.3233628571033478, 0.35054150223731995, 0.3797937035560608, 0.3880280554294586, 0.44435223937034607, 0.5243164300918579, 0.5777077078819275, 0.6586531400680542, 0.7209755778312683, 0.7613663673400879, 0.7667796611785889, 0.7864909172058105, 0.7986206412315369, 0.8155120015144348, 0.8310289978981018, 0.8578326106071472, 0.871429443359375, 0.9029029607772827, 0.8973071575164795, 0.9135904312133789, 0.9225797653198242, 0.9303504228591919, 0.9372859001159668, 0.9372039437294006, 0.9201292991638184, 0.9100725054740906, 0.887211799621582, 0.8817514777183533, 0.8608898520469666, 0.8459957242012024, 0.8267675638198853, 0.8346765637397766, 0.8136270642280579]
x_rec_d26= [-0.002296927385032177, -0.0022482227068394423, -0.003169207600876689, -0.002456375863403082, -0.00340226199477911, -0.003513169474899769, -0.003788324072957039, -0.0022220960818231106, -0.002318114973604679, -0.002905242843553424, -0.0030068536289036274, -0.002872754819691181, -0.0032343813218176365, -0.002494217362254858, -0.0030170276295393705, -0.003095989115536213, -0.0036413136404007673, -0.0030436154920607805, -0.003405635477975011, -0.003193780779838562, -0.0033568975050002337, -0.0026222148444503546, -0.0030170276295393705, -0.003095989115536213, -0.0036413136404007673, -0.0030436154920607805, -0.003405635477975011, -0.003193780779838562, -0.0033568975050002337, -0.0026222148444503546, -0.0030170276295393705, -0.003095989115536213, -0.0036413136404007673, -0.002549258526414633, -0.0035445522516965866, -0.002767542377114296, -0.0031737438403069973, -0.002639930695295334, -0.002363726031035185, -0.0035916841588914394, -0.004682932980358601, -0.004253133665770292, -0.005323261488229036, -0.00508075812831521, -0.004618064034730196, -0.00389563525095582, -0.0047249579802155495, -0.004888688214123249, -0.0064593772403895855, -0.005964138079434633, -0.005201868712902069, -0.004610213916748762, -0.0017130807973444462, -0.002815192099660635, -0.0018439400009810925, -0.004408332984894514, -0.0047500464133918285, -0.005286309868097305, -0.003927783574908972, -0.004602860193699598, -0.0022760885767638683, -0.0009164318908005953, -0.0019167386926710606, -0.006176368799060583, -0.015278667211532593, -0.024066774174571037, -0.027745794504880905, -0.024787627160549164, -0.010299969464540482, -0.004973236005753279, 0.005911674816161394, 0.008430510759353638, -0.006821188610047102, -0.017061356455087662, -0.02695024572312832, -0.018021732568740845, 0.012143250554800034, 0.032239880412817, 0.07971955835819244, 0.11698364466428757, 0.13100677728652954, 0.15354743599891663, 0.15208211541175842, 0.15627002716064453, 0.14768320322036743, 0.13373294472694397, 0.12845030426979065, 0.1194881722331047, 0.11040999740362167, 0.10741905122995377, 0.12064442038536072, 0.15555766224861145, 0.2129819542169571, 0.24410977959632874, 0.30537334084510803, 0.3471238613128662, 0.3650716245174408, 0.3825875222682953, 0.38866153359413147, 0.4432410001754761, 0.5264456272125244, 0.584710955619812, 0.6691751480102539, 0.7305073738098145, 0.7559550404548645, 0.7525677680969238, 0.7583904266357422, 0.7641185522079468, 0.7867759466171265, 0.8042371273040771, 0.8454530835151672, 0.8689446449279785, 0.9023540616035461, 0.8997783064842224, 0.9079748392105103, 0.9134779572486877, 0.9112201929092407, 0.916193962097168, 0.9138579368591309, 0.9017702341079712, 0.9009146094322205, 0.8848918676376343, 0.8856363296508789, 0.8738834261894226, 0.8580442667007446, 0.8411531448364258, 0.8494012355804443, 0.8228592872619629]
SNRc26=22.5
SNRd26=22.7
Hc26=88.5
R26=89
x_rec_c42= [-0.5443781614303589, -0.5593266487121582, -0.5785688161849976, -0.5927130579948425, -0.6104440093040466, -0.6253960728645325, -0.6375259160995483, -0.6442216634750366, -0.6568030118942261, -0.6628402471542358, -0.6783344745635986, -0.6778303384780884, -0.6715736389160156, -0.6698580384254456, -0.6595965623855591, -0.6300102472305298, -0.6015530824661255, -0.5459772348403931, -0.5307226181030273, -0.4951349198818207, -0.46323782205581665, -0.45710355043411255, -0.43219342827796936, -0.40613943338394165, -0.37509962916374207, -0.34085890650749207, -0.30636247992515564, -0.2562573254108429, -0.20615534484386444, -0.16354863345623016, -0.13041801750659943, -0.07800083607435226, -0.02156221494078636, 0.018463585525751114, 0.06500803679227829, 0.1147555261850357, 0.18647035956382751, 0.21705830097198486, 0.2743545174598694, 0.32361388206481934, 0.3649340867996216, 0.40132346749305725, 0.4274110794067383, 0.46760430932044983, 0.49568185210227966, 0.5163651704788208, 0.542871356010437, 0.5685091018676758, 0.6158039569854736, 0.6376847624778748, 0.6758273243904114, 0.6970811486244202, 0.7125976085662842, 0.719444215297699, 0.7287404537200928, 0.7401741743087769, 0.7665929794311523, 0.7803822159767151, 0.8046808838844299, 0.8270632028579712, 0.8278821706771851, 0.8220967054367065, 0.8240232467651367, 0.8115576505661011, 0.8215942978858948, 0.8149845600128174, 0.8232869505882263, 0.8248953819274902, 0.8118012547492981, 0.8116921186447144, 0.7995627522468567, 0.7833889126777649, 0.7911548614501953, 0.7823445796966553, 0.7916480302810669, 0.7769664525985718, 0.7450376152992249, 0.7213635444641113, 0.6999761462211609, 0.6596270799636841, 0.635333776473999, 0.6165556907653809, 0.5950393080711365, 0.5752611756324768, 0.5343641042709351, 0.5199494361877441, 0.4733826816082001, 0.4217168390750885, 0.38694435358047485, 0.3510337471961975, 0.3337061405181885, 0.28833162784576416, 0.2467440664768219, 0.21653786301612854, 0.18534083664417267, 0.13272860646247864, 0.07214448601007462, 0.02570251002907753, -0.027794208377599716, -0.08407888561487198, -0.16735327243804932, -0.2007751315832138, -0.26230257749557495, -0.31336063146591187, -0.3537910282611847, -0.38543346524238586, -0.4089883267879486, -0.4474639594554901, -0.48522400856018066, -0.5062652826309204, -0.5403111577033997, -0.5688532590866089, -0.6215089559555054, -0.6295531988143921, -0.6696298122406006, -0.6991082429885864, -0.7375913858413696, -0.7570004463195801, -0.7855402231216431, -0.7950965166091919, -0.8081849217414856, -0.8098918795585632, -0.8250441551208496, -0.8240038752555847, -0.8196174502372742, -0.8301728367805481, -0.8432861566543579, -0.8398459553718567]
x_rec_d42= [-0.5425801873207092, -0.5561227798461914, -0.5751224756240845, -0.5880001783370972, -0.6051560044288635, -0.615924596786499, -0.6266593933105469, -0.6319538354873657, -0.6411309242248535, -0.6461467742919922, -0.6616092920303345, -0.6588742136955261, -0.6552814245223999, -0.651654064655304, -0.641966700553894, -0.614202082157135, -0.589777946472168, -0.5375996828079224, -0.5231372117996216, -0.48504942655563354, -0.44572973251342773, -0.43572553992271423, -0.4068004786968231, -0.38394322991371155, -0.3688465356826782, -0.3450433015823364, -0.32466375827789307, -0.28126928210258484, -0.22530221939086914, -0.18029004335403442, -0.13230165839195251, -0.06988983601331711, -0.012301620095968246, 0.029293645173311234, 0.06669353693723679, 0.11229600012302399, 0.17274975776672363, 0.19705185294151306, 0.2508547902107239, 0.29953238368034363, 0.34389835596084595, 0.38092634081840515, 0.41192060708999634, 0.45844244956970215, 0.48965734243392944, 0.5140158534049988, 0.5390774011611938, 0.5618035793304443, 0.601662278175354, 0.614780604839325, 0.6512863636016846, 0.6744152307510376, 0.7022313475608826, 0.7143246531486511, 0.7335772514343262, 0.7475929856300354, 0.7677688002586365, 0.7750144600868225, 0.7926703691482544, 0.8083428740501404, 0.8141101598739624, 0.8112686276435852, 0.8235480785369873, 0.8169981837272644, 0.8240739703178406, 0.8145274519920349, 0.8175362348556519, 0.8175508975982666, 0.8045021295547485, 0.8034764528274536, 0.7922098636627197, 0.7732643485069275, 0.7654391527175903, 0.7464438676834106, 0.7444076538085938, 0.7282285690307617, 0.707927405834198, 0.6901034116744995, 0.68509441614151, 0.6558607816696167, 0.6300490498542786, 0.6072509288787842, 0.575314998626709, 0.5560414791107178, 0.5158439874649048, 0.5061578750610352, 0.4701870083808899, 0.42923668026924133, 0.3994809687137604, 0.3639063835144043, 0.3442709445953369, 0.2964384853839874, 0.24949951469898224, 0.21785882115364075, 0.18135136365890503, 0.12585583329200745, 0.0629025474190712, 0.014140669256448746, -0.03674101456999779, -0.08861866593360901, -0.15985628962516785, -0.18646149337291718, -0.24024969339370728, -0.28998562693595886, -0.3369407057762146, -0.3750462234020233, -0.4099979102611542, -0.45978662371635437, -0.5001593232154846, -0.5254914164543152, -0.557076096534729, -0.5834934711456299, -0.6342306137084961, -0.6389340162277222, -0.6773877739906311, -0.7023304104804993, -0.7344949245452881, -0.7510679364204407, -0.7748317122459412, -0.7846930623054504, -0.8029853105545044, -0.8085123896598816, -0.8345886468887329, -0.8365641832351685, -0.8339353799819946, -0.8414299488067627, -0.854743480682373, -0.8494933247566223]
SNRc42=21.3
SNRd42=21.1
Hc42=87.5
R42=89
x_rec_c51= [0.015201621688902378, 0.01886618882417679, -0.0014080656692385674, 0.00436281505972147, 0.01613692194223404, 0.03893735259771347, 0.031596966087818146, 0.027111493051052094, 0.013607152737677097, -0.0181419774889946, -0.06945625692605972, -0.08135516941547394, -0.12003355473279953, -0.11470680683851242, -0.07555397599935532, -0.04321592301130295, -0.012040487490594387, 0.07245040684938431, 0.07059163600206375, 0.042480893433094025, -0.13784800469875336, -0.28349822759628296, -0.5117437839508057, -0.8755123615264893, -1.2544450759887695, -1.4552602767944336, -1.747620940208435, -1.9578220844268799, -2.0034470558166504, -2.03788161277771, -2.017566680908203, -1.9899674654006958, -2.1108975410461426, -2.210028886795044, -2.21762752532959, -2.266338586807251, -2.2654740810394287, -2.396821975708008, -2.3322532176971436, -2.2080495357513428, -2.159245729446411, -2.132636070251465, -2.1241962909698486, -2.170661687850952, -2.144967555999756, -1.9985069036483765, -2.0280892848968506, -1.7508776187896729, -1.5919197797775269, -1.1710221767425537, -1.075221300125122, -0.7019076943397522, -0.14162318408489227, 0.21228666603565216, 0.5791378021240234, 0.8281221985816956, 0.8831613063812256, 0.9229167103767395, 1.095908284187317, 0.9940436482429504, 1.2417988777160645, 1.3433020114898682, 1.4401118755340576, 1.630521297454834, 1.640608310699463, 1.6574835777282715, 1.5874963998794556, 1.3421454429626465, 0.9798735976219177, 0.7205094695091248, 0.5247186422348022, 0.5479609370231628, 0.785877525806427, 0.9242241382598877, 1.1898566484451294, 1.485219120979309, 1.4943052530288696, 1.5295608043670654, 1.450171947479248, 1.3572068214416504, 1.296830415725708, 1.234405517578125, 1.3090903759002686, 1.408775806427002, 1.5952129364013672, 1.731512188911438, 1.8538811206817627, 1.8760197162628174, 1.8343093395233154, 1.7784709930419922, 1.758652687072754, 1.6733858585357666, 1.6735481023788452, 1.6632341146469116, 1.7399661540985107, 1.7737549543380737, 1.827216386795044, 1.852043628692627, 1.8257911205291748, 1.793209195137024, 1.6650328636169434, 1.6031051874160767, 1.4984920024871826, 1.3965139389038086, 1.3833444118499756, 1.3470379114151, 1.3370418548583984, 1.3045812845230103, 1.2190449237823486, 1.1572121381759644, 1.089188814163208, 0.959775984287262, 0.8514907360076904, 0.7573702931404114, 0.6998816132545471, 0.6390934586524963, 0.55074143409729, 0.5181129574775696, 0.4341329336166382, 0.3447292745113373, 0.24589969217777252, 0.15808357298374176, 0.07418552786111832, -0.0037764525040984154, -0.06806986778974533, -0.1395118087530136, -0.1843700259923935, -0.22669413685798645]
x_rec_d51= [0.05708010494709015, 0.05629632994532585, 0.029167260974645615, 0.032097868621349335, 0.024563871324062347, 0.0405474528670311, 0.02919192612171173, 0.012039639987051487, -0.0038679754361510277, -0.03702311962842941, -0.0919562354683876, -0.09575625509023666, -0.1318492442369461, -0.12065508216619492, -0.06399281322956085, -0.023442856967449188, 0.006712698377668858, 0.09043962508440018, 0.08305300027132034, 0.05961591750383377, -0.11211346834897995, -0.2522079348564148, -0.46829575300216675, -0.8278767466545105, -1.2132081985473633, -1.4235025644302368, -1.7176344394683838, -1.926385521888733, -1.9563542604446411, -1.9816776514053345, -1.944474458694458, -1.9111560583114624, -2.0354604721069336, -2.1446316242218018, -2.173762083053589, -2.2324392795562744, -2.2390730381011963, -2.363983392715454, -2.2938878536224365, -2.163355588912964, -2.1093478202819824, -2.085301399230957, -2.060678243637085, -2.0835139751434326, -2.038964033126831, -1.8812448978424072, -1.8899586200714111, -1.6075077056884766, -1.4617773294448853, -1.0706984996795654, -0.9908583760261536, -0.6405342221260071, -0.12239324301481247, 0.20131658017635345, 0.5483450293540955, 0.7875433564186096, 0.8292821645736694, 0.8684430122375488, 1.0157010555267334, 0.9277724623680115, 1.1648582220077515, 1.2633535861968994, 1.3604955673217773, 1.552310585975647, 1.581770658493042, 1.6064202785491943, 1.5417609214782715, 1.3067669868469238, 0.9377191662788391, 0.682354211807251, 0.4807197153568268, 0.5065839886665344, 0.7614724040031433, 0.9173135757446289, 1.2060368061065674, 1.5123199224472046, 1.5236732959747314, 1.5574314594268799, 1.462541103363037, 1.365407943725586, 1.310255527496338, 1.25526762008667, 1.3422991037368774, 1.449101448059082, 1.64598548412323, 1.7813286781311035, 1.9048593044281006, 1.919542908668518, 1.8836956024169922, 1.830521821975708, 1.8140069246292114, 1.721743106842041, 1.7175440788269043, 1.6986875534057617, 1.7631068229675293, 1.7851568460464478, 1.8311543464660645, 1.8474664688110352, 1.831070899963379, 1.8078819513320923, 1.707812786102295, 1.6581250429153442, 1.567302942276001, 1.4633818864822388, 1.4267385005950928, 1.3717374801635742, 1.3519572019577026, 1.3076844215393066, 1.24428391456604, 1.1929969787597656, 1.1508936882019043, 1.0348167419433594, 0.9115973711013794, 0.7948399186134338, 0.7115031480789185, 0.6405050754547119, 0.5458996891975403, 0.5222413539886475, 0.45121270418167114, 0.3779508173465729, 0.272838294506073, 0.1748683601617813, 0.06324460357427597, -0.02896391600370407, -0.11817621439695358, -0.202668234705925, -0.26070839166641235, -0.3072091042995453]
SNRc51=18.0
SNRd51=19.0
Hc51=255.8
R51=181
x_rec_c54= [0.897848904132843, 0.8997652530670166, 0.9126593470573425, 0.9138659238815308, 0.9220731258392334, 0.9140653610229492, 0.9116901159286499, 0.9044262170791626, 0.8940693140029907, 0.875676155090332, 0.8752318620681763, 0.8578274250030518, 0.8351556658744812, 0.8206099271774292, 0.8019457459449768, 0.7686002254486084, 0.7523602843284607, 0.7058110237121582, 0.7034463882446289, 0.6669456362724304, 0.6173821091651917, 0.5931094288825989, 0.544710636138916, 0.5054237246513367, 0.48147448897361755, 0.45311620831489563, 0.4318675696849823, 0.3937664031982422, 0.33749812841415405, 0.29951006174087524, 0.2695775032043457, 0.22077706456184387, 0.17871977388858795, 0.16603121161460876, 0.13020631670951843, 0.09874887019395828, 0.0381406731903553, -0.005995828192681074, -0.0736120268702507, -0.13497856259346008, -0.17391003668308258, -0.2023639678955078, -0.23252734541893005, -0.2639017701148987, -0.3294573724269867, -0.3591368794441223, -0.41357722878456116, -0.4652552306652069, -0.4975317716598511, -0.5027344822883606, -0.5259547233581543, -0.5723651051521301, -0.6085162162780762, -0.6626715660095215, -0.7240162491798401, -0.7381378412246704, -0.7269771695137024, -0.6692783832550049, -0.49796196818351746, -0.32524457573890686, -0.033646758645772934, 0.1756613850593567, 0.3633270263671875, 0.525799572467804, 0.4592422544956207, 0.37187454104423523, 0.256762832403183, 0.1684674620628357, 0.0858849361538887, 0.08208627253770828, 0.06582210212945938, 0.06572233140468597, 0.006869022268801928, -0.04840977489948273, -0.14572200179100037, -0.16936525702476501, -0.24544182419776917, -0.26807907223701477, -0.2726769745349884, -0.3170989155769348, -0.3540710508823395, -0.4186932444572449, -0.45159146189689636, -0.5137114524841309, -0.5566067695617676, -0.590733528137207, -0.6350754499435425, -0.6566110849380493, -0.6764639019966125, -0.6863765716552734, -0.7071839570999146, -0.7415663003921509, -0.7619699239730835, -0.7729629278182983, -0.8120408058166504, -0.8294766545295715, -0.8583844900131226, -0.8525317907333374, -0.8760310411453247, -0.8898054957389832, -0.8929002285003662, -0.8986146450042725, -0.9089882373809814, -0.9034701585769653, -0.9032794833183289, -0.8922269344329834, -0.8923158645629883, -0.886692464351654, -0.8755890727043152, -0.8626759052276611, -0.8658710718154907, -0.8421348333358765, -0.8270933628082275, -0.7962530851364136, -0.7749828100204468, -0.7561749219894409, -0.7182149887084961, -0.705854058265686, -0.6772104501724243, -0.6388987302780151, -0.6130502223968506, -0.5792564749717712, -0.5529017448425293, -0.5183590054512024, -0.47847750782966614, -0.44109705090522766, -0.4176786541938782, -0.3790278136730194]
x_rec_d54= [0.9255548715591431, 0.92351233959198, 0.930272102355957, 0.9289530515670776, 0.9247399568557739, 0.9121094346046448, 0.9077723026275635, 0.8922027945518494, 0.8781132698059082, 0.8584198951721191, 0.8503254652023315, 0.8386952877044678, 0.8178861737251282, 0.8058990240097046, 0.7996251583099365, 0.7739013433456421, 0.7604519128799438, 0.7174804210662842, 0.7141133546829224, 0.6816880106925964, 0.6365022659301758, 0.6121495366096497, 0.5663361549377441, 0.5237553119659424, 0.48964908719062805, 0.4532650411128998, 0.4277307391166687, 0.3833160698413849, 0.33312228322029114, 0.2965177297592163, 0.26829996705055237, 0.21857470273971558, 0.16655322909355164, 0.13773766160011292, 0.09360606968402863, 0.06085657700896263, 0.011830825358629227, -0.019924815744161606, -0.06981683522462845, -0.11205922812223434, -0.14579638838768005, -0.17585602402687073, -0.21125619113445282, -0.25071945786476135, -0.32617318630218506, -0.359557181596756, -0.41958996653556824, -0.47458386421203613, -0.5065610408782959, -0.5122143626213074, -0.5347240567207336, -0.5829102993011475, -0.6155539751052856, -0.6662853956222534, -0.7276921272277832, -0.7354241609573364, -0.7220979928970337, -0.6598120927810669, -0.4850015640258789, -0.3111461102962494, -0.02124924585223198, 0.19025114178657532, 0.36970055103302, 0.5312051773071289, 0.46038684248924255, 0.37132027745246887, 0.25453323125839233, 0.1595817655324936, 0.06761055439710617, 0.0608823336660862, 0.04032120481133461, 0.04125015810132027, -0.002588714938610792, -0.04697507247328758, -0.1335844099521637, -0.14992690086364746, -0.23366186022758484, -0.2605549395084381, -0.27977868914604187, -0.3376345932483673, -0.38006791472435, -0.4457639455795288, -0.46820375323295593, -0.5254582762718201, -0.5550075173377991, -0.5841838121414185, -0.6257842779159546, -0.6544743776321411, -0.6881726384162903, -0.7066283226013184, -0.737194299697876, -0.7807786464691162, -0.7948780059814453, -0.8058045506477356, -0.8335868120193481, -0.8424056768417358, -0.8695073127746582, -0.86152184009552, -0.889877438545227, -0.9017996788024902, -0.905771017074585, -0.9111229777336121, -0.9177599549293518, -0.9104530215263367, -0.9137688279151917, -0.9062430262565613, -0.9124119281768799, -0.9063026905059814, -0.8937760591506958, -0.8778862357139587, -0.8742514848709106, -0.8444160223007202, -0.8261858820915222, -0.7918604016304016, -0.7712241411209106, -0.7495472431182861, -0.7101665735244751, -0.6982123255729675, -0.6688467860221863, -0.6309797763824463, -0.6093506813049316, -0.5795159935951233, -0.5532870292663574, -0.5182163119316101, -0.4723341166973114, -0.4303911030292511, -0.40108534693717957, -0.3558894991874695]
SNRc54=18.7
SNRd54=18.7
Hc54=210.0
R54=133

curve_tex(np.array([i for i in range(128)]),90000*np.array(x_rec_c54)/(1000),0.5)
curve_tex(np.array([i for i in range(128)]),90000*np.array(x_rec_d54)/(1000),0.5)    
    
zrgrg

if DATA_i_load==1:
    
    loaded = np.load(r'D:\Users\presvotscor\Documents\These_clean\Code_MMC\DATA_i.npz')
    DATA_i=loaded['DATA_i']
    print("shape i",np.shape(DATA_i))

if DATA_S_load==1:
    
    loaded = np.load(r'D:\Users\presvotscor\Documents\These_clean\Code_MMC\DATA.npz')    
    DATA_S=loaded['DATA_S']
    print("shape S",np.shape(DATA_S))
    
    for w in range(0):
        fig=plt.figure(figsize=(8,5),dpi=100)
        plt.plot(t[0:5000],DATA_S[w][0][0:5000]*Delta,lw=2,label='v1{}'.format(w))
        plt.plot(t[0:5000],DATA_S[w][1][0:5000]*Delta,lw=2,label='v2{}'.format(w))
        plt.plot(t[0:5000],DATA_S[w][2][0:5000]*Delta,lw=2,label='v3{}'.format(w))
        plt.xlabel('t (s)')
        plt.ylabel('Voltage (V)')
        plt.grid( which='major', color='#666666', linestyle='-')
        plt.legend()
        plt.minorticks_on()
    
    
    good_signals=np.array([85,91,98,176,189,195,282,287,316,337,371,380])
    DATA_S2=DATA_S[good_signals]
    #DATA_S2=np.zeros((len(good_signals),6,21000))
    #for i in range(len(good_signals)):
    #    DATA_S2[i]=DATA_S[good_signals[i]]
    
    
    for w in range(len(good_signals)):
        fig=plt.figure(figsize=(8,5),dpi=100)
        plt.plot(t[0:5000],DATA_S2[w][0][0:5000]*Delta,lw=2,label='v1{}'.format(w))
        plt.plot(t[0:5000],DATA_S2[w][1][0:5000]*Delta,lw=2,label='v2{}'.format(w))
        plt.plot(t[0:5000],DATA_S2[w][2][0:5000]*Delta,lw=2,label='v3{}'.format(w))
        plt.xlabel('t (s)')
        plt.ylabel('Voltage (V)')
        plt.grid( which='major', color='#666666', linestyle='-')
        plt.legend()
        plt.minorticks_on()
        
        
    print("shape S2",np.shape(DATA_S2))
    np.savez_compressed(r'D:\Users\presvotscor\Documents\These_clean\Code_MMC\DATA_S2', DATA_S2=DATA_S2)
    
    
    
